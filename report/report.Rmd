---
title: '<header style="text-align: center">
			<h1 style="font-weight: bold; font-size: 44px">2016 Brussels Bombings</h1>
			<h2>Air Traffic Analysis</h2>
		</header>'
author: '<div style="text-align: center">
			<span style="display: inline-block; width: 30%; margin: 0 5px">[Ramiro Balado Ordax](https://github.com/Qjammer)</span>
			<span style="display: inline-block; width: 30%; margin: 0 5px">[Alejandro Hernández Rubio](https://github.com/Shyryuu)</span>
			<span style="display: inline-block; width: 30%; margin: 0 5px">[Pol Mesalles Ripoll](https://github.com/polmes)</span>
		</div>'
# date: "DD/MM/YYYY"
output:
    rmarkdown::html_document:
        theme: cosmo
        highlight: tango
        number_sections: true
        toc: true
        toc_float: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Air Traffic

## Air Traffic Evolution

```{r, fig.align='center'}
ddr.times(data$real$flights, bru, event)
```

## Diverted Flights {.tabset .tabset-fade}

On the day of the event, March 22, 2016, there were a total of `r div[, .N]` diverted flights that had intended to land on Brussels Airport (EBBR).

```{r, fig.align='center'}
datatable(info[, .(orig, dest, airline, diff, fuel)], options = list(dom = 'tp', columnDefs = list(list(className = 'dt-center', targets = '_all'))), colnames = c('Origin', 'Destination', 'Airline', 'Distance Delta (NM)', 'Fuel Delta (kg)')) %>%
	formatRound(columns = c('diff', 'fuel'), digits = 2)
```

On average, airlines actually saved `r format(abs(info[, mean(fuel)]), digits = 3)` kg of fuel by diverting flights to airports closer to the origin point.

### Static Map {-}

```{r, fig.align='center'}
ddr.map(data$real$routes[id %in% div[, id]], autocenter = FALSE)
```

### Interactive Map {-}

```{r, fig.align='center'}
ddr.jsmap(data$real$routes[id %in% div[, id]], info, coord)
```

### Animation {-}

```{r, message=FALSE, results=FALSE}
gifname <- 'diverted'
giffile <- file.path('..', 'data', paste0(gifname, '.gif'))
if (!file.exists(giffile)) {
	ddr.animate(data$real$routes[id %in% div[, id]], giffile)
}
```
![Diverted Flights Map Animation](`r giffile`) \


## TODO

- N flights vs. time with orig/dest at EBBR
- N diverted flights vs. time with dest EBBR

# Airports

The nearby airports to EBBR include:

- EBCI (Brussels South Charleroi)
- EBLF (Liège)
- EHEH (Eindhoven)
- EBAW (Antwerp)
- LFQQ (Lille)

## Traffic in nearby airports

Find # of flights in nearby airports

## Delays in nearby airports

- Statistics (mean + sigma) for delays on each airport per day

# Airlines
